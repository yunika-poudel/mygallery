"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7548],{7548:function(n,l,t){t.d(l,{j:function(){return C}});var e={};t.r(e),t.d(e,{button:function(){return i},inline:function(){return s},span:function(){return b}});var o=t(97458),a=t(32748);t(19401),t(63807),t(30326);var r=t(22319),i=(0,r.c)({defaultClassName:"_bglng85 _1286nb12iw _1286nb128w _1286nb123k _1286nb12dk _1286nb14ke _1286nb14lq _1286nb14n2 _1286nb14oe _1286nb12re _1286nb12o2 _1286nb13pk _1286nb119",variantClassNames:{mode:{follow:"_bglng82 _1286nb16ft _1286nb17t2 _1286nb17yz",following:"_bglng84 _1286nb16ft _1286nb16nh _1286nb17t2 _1286nb186q"}},defaultVariants:{mode:"follow"},compoundVariants:[]}),s=(0,r.c)({defaultClassName:"_bglng8e _bglng89 _1286nb119",variantClassNames:{mode:{follow:"_bglng8b _1286nb16ft",following:"_bglng8d _1286nb16ft _1286nb16nh"}},defaultVariants:{mode:"follow"},compoundVariants:[]}),b="_bglng8h",c=t(96005),u=t(42011),f=t(52983),_=t(51835),w=t(95815);let d=async()=>{let n=await fetch("/api/social/follow");if(!n.ok)throw Error();return await n.json()},g=(0,_.cn)({key:"userFollowsState",default:[],effects:[n=>{let{setSelf:l}=n;(async()=>{let n=async()=>await d();l(await n())})()}]}),h=(0,_.CG)({key:"authorUserFollow",get:n=>{let{id:l}=n;return n=>{let{get:t}=n;return!!t(w.UA)&&t(g).includes(l)}},set:n=>{let{id:l}=n;return(n,t)=>{let{get:e,set:o}=n,a=e(g);o(g,t?a.filter(n=>n!==l):[...a,l])}}});var m=t(51362);let k=async(n,l)=>{if(!(await fetch("/api/social/follow?id=".concat(l),{method:n?"DELETE":"PUT"})).ok)throw Error("There was a problem toggling the follow")};var p=t(62168);let N=(n,l)=>{let t=(0,p.PN)(),e={event:"ga4event",event_name:"follow_author",action:"follow_author",author_name:n,location:l,category:"follow-contributor"};return()=>t(e)},v=(n,l,t)=>{let[e,o]=(0,f.useState)(!0),{onShowToast:a}=(0,m.p)(),{loginUrl:r,setLoginCookies:i}=(0,c.J)(),s=(0,u.d)(),[b,w]=(0,_.FV)(h({id:n})),d=N(l,t),g=(0,f.useCallback)(()=>{if(!s){i(),window.location.href=r;return}o(!1),k(b,n).then(()=>w(b)).then(()=>!b&&d()).catch(()=>a()).finally(()=>o(!0))},[s,b,n,i,r,w,d,a]);return{following:b,disabled:!e,onClick:g}},C=n=>{let{id:l,name:t,location:r,buttonStyle:i="button"}=n,{t:s}=(0,a.$G)("common"),{following:c,onClick:u,disabled:f}=v(l,t,r),_="inline"===i?"inline":"button";return c?(0,o.jsxs)("button",{className:e[_]({mode:"following"}),onClick:u,disabled:f,children:[(0,o.jsx)("span",{className:b,children:s("following")}),(0,o.jsx)("span",{className:b,children:s("unfollow")})]}):(0,o.jsx)("button",{className:e[_](),onClick:u,disabled:f,children:s("follow")})}}}]);